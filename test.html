<html>
    <head>
        <title>jsonp test</title>
        <script src="http://code.jquery.com/jquery-1.6.2.min.js"></script>
        <script src="http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.5.1/underscore-min.js"></script>
        <script src="http://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.0.0/backbone-min.js"></script>
    </head>
    <body>
        <p>JSONP test: </p>
        <p><a href="#" id="testlink">Mutate Buttons Model (forces a backbone.sync)</a></p>
        <p>Here's a /download test: </p>
        <p><input id='download' type=button value="Download" /></p>
        <p>Here's a /build test: </p>
        <p><input id='update' type=button value="Update" /></p>

    <script type="text/javascript">
    $(function() {
<<<<<<< HEAD
        var defaultOptions = {
          'btn-namespace': '.button',
          'btn-colors': [
              {
                  name: 'primary',
                  background: '#00A1CB',
                  color: '#FFFFFF'
              },
              {
                  name: 'action',
                  background: '#7db500',
                  color: '#FFFFFF'
              },
              {
                  name: 'highlight',
                  background: '#F18D05',
                  color: '#FFFFFF'
              },
              {
                  name: 'caution',
                  background: '#E54028',
                  color: '#FFFFFF'
              },
              {
                  name: 'royal',
                  background: '#87318C',
                  color: '#FFFFFF'
              }
          ],
          'btn-shapes': [
            {
              name: 'pill',
              radius: '200px'
            },
            {
              name: 'rounded',
              radius: '3px'
            }
          ],
          'btn-sizes': [
            {
              name: 'giant',
              multiplier: '2'
            },
            {
              name: 'jumbo',
              multiplier: '1.5'
            },
            {
              name: 'large',
              multiplier: '1.25'
            },
            {
              name: 'normal',
              multiplier: '1'
            },
            {
              name: 'small',
              multiplier: '.75'
            },
            {
              name: 'tiny',
              multiplier: '.5'
            }
          ],
          'types': ['border', 'shapes'],
          // 'btn-name': 'button',
          'btn-height': '40px',
          'btn-bgcolor': '#EEE',
          'btn-font-color': '#666',
          'btn-font-size': '14px',
          'btn-font-weight': '300',
          'btn-font-family': ['Arial', 'sans-serif']
        };


        var JsonpModel = Backbone.Model.extend({
            module: 'buttons',
            defaults: defaultOptions,
            type: null,
            url: function() {
                // return 'http://options-compiler.herokuapp.com/build/buttons';
                return 'http://localhost:5000/build/'+this.module;
            },
            sync: function(method, model, options) {
                var url = model.url()+"?callback=?";
                var data = this.toJSON();
                console.log("URL: ", url);
                var params = _.extend({
                  type: 'GET',
                  dataType: 'jsonp',
                  data: data,
                  url: url
                }, options);
                return $.ajax(params);
            },
            parse: function(response) {
                // parse can be invoked for fetch and save, in case of save it can be undefined so check before using
                if (response && response[this.module]) {
                    return {
                        buttons: response[this.module],
                        optionsScss: response.optionsScss
                    };
                }
            }
        });

        $('#update').click(function(e) {
          var buttons = new JsonpModel();
          buttons.save();
          console.log("Updated Buttons Backbone Model: ", buttons.toJSON());
        });

        // Test straight up download using buttons.toJSON as our query string for window.open
        $('#download').click(function(e) {
            var params = $.param(defaultOptions);
=======
        // Test straight up download using buttons.toJSON as our query string for window.open
        $('#download').click(function(e) {
            var options = {
                'name': 'buttons',
                'types': ['pill', 'rounded'],
                'btn-namespace': '.button',
                'btn-name': 'button',
                'btn-glow-namespace': '.glow',
                'btn-glow-name': 'glow',
                'btn-font-color': '#666',
                'btn-font-size': '14px',
                'btn-font-weight': '300',
                'btn-font-family': ['Arial', 'sans-serif'],
                'btn-actions': [
                    {
                        name: 'primary',
                        background: '#00A1CB',
                        color: '#FFFFFF'
                    },
                    {
                        name: 'action',
                        background: '#7db500',
                        color: '#FFFFFF'
                    },
                    {
                        name: 'highlight',
                        background: '#F18D05',
                        color: '#FFFFFF'
                    },
                    {
                        name: 'caution',
                        background: '#E54028',
                        color: '#FFFFFF'
                    },
                    {
                        name: 'royal',
                        background: '#87318C',
                        color: '#FFFFFF'
                    }
                ]
            };
            var params = $.param(options);
>>>>>>> Updated test page for refactor WIP
            var url = 'http://localhost:5000/download/buttons?'+params;
            window.open(url, 'Download');
        });
    });
    </script>
    </body>
</html>
